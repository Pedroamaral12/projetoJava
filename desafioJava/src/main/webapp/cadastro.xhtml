<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui" xmlns:f="jakarta.faces.core">
<h:head>
	<title>Cadastro de Usuário</title>
</h:head>
<h:body
	style="display: flex;
    justify-content: center;
    margin-top: 100px;">
	<h:form id="formCadastro">
		<p:panel header="Cadastro de Usuário">
			<p:panelGrid columns="2" style="margin-bottom:10px">
				<p:outputLabel value="Nome:" />
				<p:inputText id="nome" value="#{usuarioController.usuario.nome}" />

				<p:outputLabel value="Email:" />
				<p:inputText id="email" value="#{usuarioController.usuario.email}" />

				<p:outputLabel value="CPF:" />
				<p:inputMask id="cpf" mask="999.999.999-99"
					value="#{usuarioController.usuario.cpf}" />

				<p:outputLabel value="Perfil:" />
				<p:selectOneMenu id="perfil"
					value="#{usuarioController.usuario.perfil}">
					<f:selectItem itemLabel="Selecione" itemValue="" />
					<f:selectItems value="#{perfilController.perfis}" var="perfil"
						itemLabel="#{perfil.descricao}" itemValue="#{perfil}" />
				</p:selectOneMenu>

				<p:outputLabel value="Endereços:" />
				<p:selectCheckboxMenu id="enderecos"
					value="#{usuarioController.enderecosSelecinados}"
					label="Selecione um ou mais endereços"
					converter="#{enderecoConverter}" filter="true"
					filterMatchMode="startsWith" filterNormalize="true" multiple="true"
					scrollHeight="250" var="endereco" style="min-width: 15rem">
					<f:selectItems value="#{enderecoController.todosEnderecos}"
						var="endereco"
						itemLabel="#{endereco.rua}, #{endereco.cidade} - #{endereco.estado}"
						itemValue="#{endereco}" />
				</p:selectCheckboxMenu>


			</p:panelGrid>
			<section style="display: flex; justify-content: space-between;">

				<div>
					<p:commandButton value="Voltar" style="margin: 5px"
						icon="pi pi-arrow-left" action="index" ajax="false" />
					<p:commandButton value="Adicionar Novo Endereço"
						style="margin: 5px" oncomplete="PF('dlgEndereco').show();"
						update="formEndereco" icon="pi pi-plus" />
				</div>
				<div>
					<p:commandButton value="Salvar" style="margin: 5px"
						action="#{usuarioController.cadastrarUsuario()}" update="@form"
						process="@form" />
				</div>

			</section>

		</p:panel>
	</h:form>
	<p:dialog header="Cadastro de Endereço" widgetVar="dlgEndereco"
		modal="true" closable="false" resizable="false">
		<h:form id="formEndereco">
			<p:panelGrid columns="2">
				<p:outputLabel value="Rua:" />
				<p:inputText id="rua" value="#{enderecoController.endereco.rua}" />

				<p:outputLabel value="Cidade:" />
				<p:inputText id="cidade"
					value="#{enderecoController.endereco.cidade}" />

				<p:outputLabel value="Estado:" />
				<p:inputText id="estado"
					value="#{enderecoController.endereco.estado}" />

				<p:outputLabel value="CEP:" />
				<p:inputMask id="cep" mask="99999-999"
					value="#{enderecoController.endereco.cep}" />
			</p:panelGrid>

			<p:commandButton value="Salvar Endereço" style="margin: 5px"
				action="#{enderecoController.salvarEndereco}"
				update="formCadastro:enderecos"
				oncomplete="PF('dlgEndereco').hide();" icon="pi pi-check" />
			<p:commandButton value="Cancelar" onclick="PF('dlgEndereco').hide();"
				icon="pi pi-times" style="margin: 5px" />
		</h:form>
	</p:dialog>
</h:body>
</html>
